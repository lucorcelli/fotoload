<div class="grid" id="produtos"></div>

<script>
function carregarProdutos() {
  const minNota = document.getElementById('minNota').value;
  const categoria = document.getElementById('categoria').value;
  const busca = document.getElementById('busca').value.toLowerCase();

  fetch('https://fotoload-api.onrender.com/produtos/destaques')
    .then(res => res.json())
    .then(produtos => {
      const grid = document.getElementById('produtos');
      grid.innerHTML = '';

      produtos
        .filter(p => (!minNota || p.nota_atual >= minNota) &&
                    (!categoria || p.categoria === categoria) &&
                    (!busca || p.nome.toLowerCase().includes(busca) ||
                      (p.codigo_barras && p.codigo_barras.includes(busca))))
        .forEach(p => {
          grid.innerHTML += `
            <div class="card">
              <img src="${p.fotos && p.fotos.length ? p.fotos[0] : '/imagens/sem-imagem.jpg'}" />
              <h3>${p.nome}</h3>
              <p>${p.descricao || 'Sem descri√ß√£o'}</p>
              <div class="nota">‚≠ê ${p.nota_atual || '‚Äì'}</div>
              <button onclick="editarProduto(${p.id})">‚úèÔ∏è Editar</button>
              <button onclick="excluirProduto(${p.id})">üóëÔ∏è Excluir</button>
            </div>
          `;
        });
    })
    .catch(err => {
      console.error('Erro ao buscar produtos:', err);
      document.getElementById('produtos').innerHTML =
        '<p>Erro ao carregar os produtos. Verifique a API.</p>';
    });
}

function editarProduto(id) {
  alert('Editar produto ' + id);
  // Aqui voc√™ pode abrir um modal com os dados do produto.
}

function excluirProduto(id) {
  if (confirm('Tem certeza que deseja excluir o produto?')) {
    fetch(`https://fotoload-api.onrender.com/produtos/${id}`, {
      method: 'DELETE'
    })
    .then(() => {
      alert('Produto exclu√≠do com sucesso!');
      carregarProdutos(); // Atualiza a lista
    })
    .catch(err => {
      alert('Erro ao excluir produto.');
      console.error(err);
    });
  }
}

// Carrega os produtos ao iniciar
carregarProdutos();
</script>